<!-- redirect.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Redirect</title>
  <!-- Lean Link SDK (keep same CDN you're using today) -->
  <script src="https://cdn.leantech.me/link/loader/prod/ae/latest/lean-link-loader.min.js"></script>
  <style>
    /* Hide everything visually */
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; background: transparent; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <!-- Nothing visible -->
  <div class="hidden" id="status">Processingâ€¦</div>

  <script>
		   function tryCaptureRedirect() {
		     const qp = new URLSearchParams(window.location.search);

		     // Only proceed if we actually returned from Lean/bank redirect
		     const customerId = qp.get("customer_id");
		     if (!customerId) return;

		     Lean.captureRedirect({
		       app_token: "3c93a8b1-577e-4161-bf30-45f205fcd451",
		       sandbox: true,
		       access_token: document.getElementById("access_token").value,

		       bank_identifier: qp.get("bank_identifier"),
		       //consent_id: qp.get("consent_id"),
		       consent_attempt_id: qp.get("consent_attempt_id"),
		       customer_id: customerId,
		       //granular_status_code: qp.get("granular_status_code"),
		       //status_additional_info: qp.get("status_additional_info"),
		     });
		   }

		   window.addEventListener("load", tryCaptureRedirect);
		 </script>
</body>
</html>
